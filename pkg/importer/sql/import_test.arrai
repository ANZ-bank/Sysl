let (:import, ...) = //{./import};

let upSqlsIn = \dir //os.tree(dir) where //seq.has_suffix('.up.sql', .path) => .path orderby .;

let simple = $`
    # Code generated by Sysl. DO NOT EDIT.

    Foo:
        !table foo:
            a <: int64? [~pk]

`;

(
    mysql: (
        import: (
            file: import('Foo', './tests/mysql/migrations/01_create_foo.up.sql') = simple,
            files: import('Foo', upSqlsIn('./tests/mysql/migrations')) = simple,
            migrations: import('Foo', './tests/mysql/migrations') = simple,
        ),
    ),

    postgresql: (
        import: (
            file: import('Foo', './tests/postgresql/migrations/01_create_foo.up.sql') = simple,
            files: import('Foo', upSqlsIn('./tests/postgresql/migrations')) = simple,
            migrations: import('Foo', './tests/postgresql/migrations') = simple,
        ),
    ),

    spanner: (
        import: (
            file: import('Foo', './tests/spanner/migrations/01_create_foo.up.sql') = simple,
            files: import('Foo', upSqlsIn('./tests/spanner/migrations')) = simple,
            migrations: import('Foo', './tests/spanner/migrations') = simple,
        ),
    ),
)
